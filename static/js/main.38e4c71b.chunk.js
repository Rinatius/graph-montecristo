(this["webpackJsonpgraph-montecristo"]=this["webpackJsonpgraph-montecristo"]||[]).push([[0],{195:function(e){e.exports=JSON.parse('{"CONTROLS":"\u0443\u0447\u0440\u0435\u0434\u0438\u0442\u0435\u043b\u044c","ANNOUNCED":"\u043e\u0431\u044a\u044f\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u0442\u0435\u043d\u0434\u0435\u0440\u044b","DIRECTOR":"\u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440","INCLUDES_LOTS":"\u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u043b\u043e\u0442\u044b","NAME_SAKE":"\u0442\u0435\u0437\u043a\u0430?","NAME_SAKE_INDIVIDUAL":"\u0442\u0435\u0437\u043a\u0430 \u0418\u041f?","PARTICIPATED_IN":"\u0443\u0447\u0430\u0441\u0442\u0432\u043e\u0432\u0430\u043b \u0432","PROBABLE_FATHER":"\u043e\u0442\u0435\u0446?","PROBABLE_SIBLING":"\u0431\u0440\u0430\u0442-\u0441\u0435\u0441\u0442\u0440\u0430?","PROBABLE_KID":"\u0441\u044b\u043d-\u0434\u043e\u0447\u044c?","SAME_INN":"\u0418\u041d\u041d","PARTICIPANTS":"\u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0438","TENDER":"\u0442\u0435\u043d\u0434\u0435\u0440","ENTITY":"\u0437\u0430\u043a\u0443\u043f\u0430\u044e\u0449\u0430\u044f \u043e\u0440\u0433","inn":"\u0418\u041d\u041d","head_name_sur":"\u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440","procurement_method":"\u043c\u0435\u0442\u043e\u0434","publication_date":"\u0434\u0430\u0442\u0430","lot_sum_int":"\u043d\u0430\u0447\u0430\u043b\u044c\u043d\u0430\u044f \u0446\u0435\u043d\u0430","region":"\u043e\u0431\u043b\u0430\u0441\u0442\u044c","district":"\u0440\u0430\u0439\u043e\u043d","street":"\u0443\u043b\u0438\u0446\u0430","home":"\u0434\u043e\u043c","apartment":"\u043a\u0432\u0430\u0440\u0442\u0438\u0440\u0430"}')},284:function(e,t,n){e.exports=n(374)},289:function(e,t,n){},290:function(e,t,n){},374:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(21),i=n.n(o),s=(n(289),n(152)),l=n(153),c=n(170),d=n(169),u=(n(290),n(248)),h=n.n(u),p=n(54),m=n(115),g=n(60),f=n(249),b=n(432),k=n(437),v=n(438),C=n(440),S=n(456),E=n(439),y=n(85),w=n(171),O=n(258),N=n.n(O),L=n(441),T=n(436),I=n(433),G=n(435),P=n(434),x=n(257),A=n.n(x),j=n(195),_=function(e,t){return e in j?"ru"==t?j[e]:void 0:e},R=n(196),z=n.n(R),B=n(197),D=n.n(B),M=n(254),H=n.n(M),J=n(256),U=n.n(J),K=n(255),Q=n.n(K),W={KgMinjust:{label:"KgMinjust",style:{backgroundColor:"#fbc02d"},icon:a.a.createElement(z.a,{style:{fontSize:30}}),svg:"https://raw.githubusercontent.com/aleks-walker/graph-montecristo-config/8f8c6843a73515bd2deb47f4b80b8cdf9c0d2451/businessYellow.svg",subHeaderUrlParam:"url",subHeaderText:"\u041c\u0438\u043d\u044e\u0441\u0442",contentTextParam:"name_ru",properties:["inn","head_name_sur","region","district","street","home","apartment"],links:["CONTROLS","DIRECTOR","SAME_INN"],reverseLinks:{}},KgMinjustParticipants:{label:"KgMinjustParticipants",style:{backgroundColor:"#fbc02d"},icon:a.a.createElement(D.a,{style:{fontSize:30}}),svg:"https://raw.githubusercontent.com/aleks-walker/graph-montecristo-config/8f8c6843a73515bd2deb47f4b80b8cdf9c0d2451/accountYellow.svg",subHeaderUrlParam:"org_url",subHeaderText:"\u041c\u0438\u043d\u044e\u0441\u0442",contentTextParam:"name",properties:["name"],links:["CONTROLS","NAME_SAKE","PROBABLE_FATHER","PROBABLE_SIBLING","PROBABLE_KID"],reverseLinks:{}},HeadNameSur:{label:"HeadNameSur",style:{backgroundColor:"#fbc02d"},icon:a.a.createElement(D.a,{style:{fontSize:30}}),svg:"https://raw.githubusercontent.com/aleks-walker/graph-montecristo-config/8f8c6843a73515bd2deb47f4b80b8cdf9c0d2451/accountYellow.svg",subHeaderUrlParam:"",subHeaderText:"\u041c\u0438\u043d\u044e\u0441\u0442",contentTextParam:"head_name_sur",properties:["head_name_sur"],links:["DIRECTOR","NAME_SAKE","PROBABLE_FATHER","PROBABLE_SIBLING","PROBABLE_KID"],reverseLinks:{}},KgProcurementParticipants:{label:"KgProcurementParticipants",style:{backgroundColor:"#00897b"},icon:a.a.createElement(z.a,{style:{fontSize:30}}),svg:"https://raw.githubusercontent.com/aleks-walker/graph-montecristo-config/8f8c6843a73515bd2deb47f4b80b8cdf9c0d2451/busiessGreen.svg",subHeaderUrlParam:"",subHeaderText:"\u0413\u043e\u0441\u0437\u0430\u043a\u0443\u043f\u043a\u0438",contentTextParam:"name",properties:["inn"],links:["PARTICIPATED_IN","NAME_SAKE_INDIVIDUAL"],reverseLinks:{}},KgProcurementLots:{label:"KgProcurementLots",style:{backgroundColor:"#00897b"},icon:a.a.createElement(H.a,{style:{fontSize:30}}),svg:"https://raw.githubusercontent.com/aleks-walker/graph-montecristo-config/8f8c6843a73515bd2deb47f4b80b8cdf9c0d2451/gavelGreen.svg",subHeaderUrlParam:"tender_url",subHeaderText:"\u0413\u043e\u0441\u0437\u0430\u043a\u0443\u043f\u043a\u0438",contentTextParam:"lot_name",properties:["lot_name","lot_sum_int"],links:["PARTICIPATED_IN","INCLUDES_LOTS"],reverseLinks:{PARTICIPATED_IN:"PARTICIPANTS",INCLUDES_LOTS:"TENDER"}},KgProcurement:{label:"KgProcurement",style:{backgroundColor:"#00897b"},icon:a.a.createElement(Q.a,{style:{fontSize:30}}),svg:"https://raw.githubusercontent.com/aleks-walker/graph-montecristo-config/13c35330a9b7ae752e04638edb39068555ae9374/monetizeGreen.svg",subHeaderUrlParam:"url",subHeaderText:"\u0422\u0435\u043d\u0434\u0435\u0440",contentTextParam:"procurement_object_no_quotes",properties:["procurement_method","publication_date"],links:["ANNOUNCED","INCLUDES_LOTS"],reverseLinks:{ANNOUNCED:"ENTITY"}},KgProcurementEntitiesWithAddresses:{label:"KgProcurementEntitiesWithAddresses",style:{backgroundColor:"#00897b"},icon:a.a.createElement(U.a,{style:{fontSize:30}}),svg:"https://raw.githubusercontent.com/aleks-walker/graph-montecristo-config/83020b7357a5888d237b3661800fec934f692be8/orgTenderGreen.svg",subHeaderUrlParam:"",subHeaderText:"\u0417\u0430\u043a\u0443\u043f\u0430\u044e\u0449\u0430\u044f \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f",contentTextParam:"procuring_entity",properties:["district"],links:["ANNOUNCED"],reverseLinks:{}}},Z={CONTROLS:{properties:[],linkConf:{fontSize:14}},ANNOUNCED:{properties:[],linkConf:{fontSize:14}},DIRECTOR:{properties:[],linkConf:{fontSize:14}},INCLUDES_LOTS:{properties:[],linkConf:{fontSize:14}},NAME_SAKE:{properties:[],linkConf:{fontSize:14}},NAME_SAKE_INDIVIDUAL:{properties:[],linkConf:{fontSize:14}},PROBABLE_FATHER:{properties:[],linkConf:{fontSize:14}},PARTICIPATED_IN:{properties:["proposed_price","result"],result:[{value:"(\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u043e)",regex:!0,color:"red"}],linkConf:{fontSize:14}},PROBABLE_SIBLING:{properties:[],linkConf:{fontSize:14}},PROBABLE_KID:{properties:[],linkConf:{fontSize:14}},SAME_INN:{properties:[],linkConf:{fontSize:14}}},F=Object(b.a)((function(e){return{root:{backgroundColor:e.palette.background.paper,padding:"1px"},nested:{paddingLeft:e.spacing(4),padding:"1px"},listItemIcon:{minWidth:"auto"}}})),Y=a.a.memo((function(e){var t=F(),n=a.a.useState(!0),r=Object(g.a)(n,2),o=(r[0],r[1],e.vGraph.toJS().nodes,e.vGraph.toJS().edges,e.iGraph.toJS().nodes,e.iGraph.toJS().edges),i=Object.keys(o).map((function(t){if(e.node.id.toString()==o[t].source.toString()||e.node.id.toString()==o[t].target.toString())return o[t].type})).reduce((function(e,t){return e[t]?e[t]++:e[t]=1,e}),{});i=Object.keys(i).reduce((function(e,t){return"undefined"!==t&&(e[t]=i[t]),e}),{});var s=e.node.labels[0],l=Object.keys(i).map((function(n){if(W[s]&&W[s].links&&W[s].links.includes(n)){var r=function(t){var n=Object.keys(o).map((function(n){if(o[n].type==t&&(e.node.id.toString()==o[n].source.toString()||e.node.id.toString()==o[n].target.toString()))return n}));return n=n.filter((function(e){return void 0!==e}))}(n),l="";return l=0!==Object.keys(W[s].reverseLinks).length&&Object.keys(W[s].reverseLinks).includes(n)?W[s].reverseLinks[n]:n,a.a.createElement(I.a,{key:n,style:{padding:"1px"},button:!0,onClick:function(){return e.onButtonClick(r,e.node.id)}},a.a.createElement(P.a,{primary:_(l,"ru")+" ("+i[n]+")",primaryTypographyProps:{variant:"body2"}}),a.a.createElement(G.a,{className:t.listItemIcon},a.a.createElement(A.a,null)))}}));return a.a.createElement(T.a,{component:"nav","aria-labelledby":"nested-list-subheader",className:t.root},l)}),(function(e,t){return e.vGraph===t.vGraph&&e.iGraph===t.iGraph&&e.node===t.node})),V=function(e){var t=new RegExp("\u043e\u0431\u0449\u0435\u0441\u0442\u0432\u043e \u0441 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u043e\u0439 \u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u044c\u044e","i");return e.replace(t,"\u041e\u0441\u041e\u041e")},q=function(e){var t=new Date(e),n=t.getHours()+":"+t.getMinutes(),r=t.getDate(),a=t.getMonth()+1;return(r=r<10?"0"+r:r)+"."+(a=a<10?"0"+a:a)+"."+t.getFullYear()+" "+n},X=Object(b.a)((function(e){return{contentTextParam:{fontWeight:"bold",marginBottom:"5px"}}})),$=a.a.memo((function(e){var t=X(),n=[],r=e.node.labels[0];return Object.keys(W).includes(r)&&W[r].properties.forEach((function(t){W[r].properties&&W[r].properties.includes(t)&&W[r].contentTextParam!==t&&n.push(a.a.createElement(y.a,{key:t+r,variant:"body2",color:"textPrimary",component:"p"},"publication_date"===t?_(t,"ru")+": "+q(e.node.properties[t]):_(t,"ru")+": "+e.node.properties[t]))})),console.log(e.node.properties[W[r].contentTextParam]),a.a.createElement("div",null,a.a.createElement(y.a,{className:t.contentTextParam,variant:"body2",color:"textPrimary",component:"p"},V(e.node.properties[W[r].contentTextParam])),n)}),(function(e,t){return e.node.properties===t.node.properties})),ee=Object(b.a)((function(e){return{root:{maxWidth:240,textAlign:"left",height:"auto"},media:{height:0},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},avatar:{backgroundColor:w.a[500]},cardContent:{paddingTop:0,paddingBottom:0,"&:last-child":{paddingBottom:7}}}})),te=a.a.memo((function(e){var t=Object(r.useRef)(),n=Object(r.useState)({width:0,height:0}),o=Object(g.a)(n,2),i=o[0],s=o[1];e.getDimensions(i.height,e.node.id),Object(r.useEffect)((function(){t.current&&s({width:10*t.current.offsetWidth,height:10*t.current.offsetHeight+20})}),[]);var l=ee(),c={},d="",u="";if(Object.keys(W).includes(e.node.labels[0])){var h=e.node.labels[0];c=W[h].style,d=W[h].icon,u=a.a.createElement("a",{href:e.node.properties[W[h].subHeaderUrlParam],target:"_blank"},W[h].subHeaderText)}return a.a.createElement(k.a,{className:l.root,ref:t},a.a.createElement(v.a,{avatar:a.a.createElement(S.a,{"aria-label":"recipe",className:l.avatar,style:c},d),action:a.a.createElement(E.a,{"aria-label":"settings",onClick:function(){return e.onMinimizeClick(e.node.id)}},a.a.createElement(N.a,null)),subheader:a.a.createElement(y.a,null,u)}),a.a.createElement(C.a,{classes:{root:l.cardContent}},a.a.createElement($,{node:e.node}),a.a.createElement(L.a,{style:{marginTop:8}}),a.a.createElement(Y,{node:e.node,vGraph:e.vGraph,iGraph:e.iGraph,onButtonClick:e.onButtonClick})))}),(function(e,t){return e.vGraph===t.vGraph&&e.iGraph===t.iGraph})),ne={},re=a.a.memo((function(e){var t=Object(r.useState)({}),n=Object(g.a)(t,2),o=(n[0],n[1]),i=Object(r.useState)(window.innerHeight-110),s=Object(g.a)(i,2),l=s[0],c=s[1],d=Object(r.useState)(window.innerWidth),u=Object(g.a)(d,2),h=u[0],p=u[1];Object(r.useEffect)((function(){function e(){c(window.innerHeight-110),p(window.innerWidth)}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]);var b=null;e.zoom&&(b=e.zoom),Object(r.useEffect)((function(){e.resetZoom(null)}),[]);var k={height:l,width:h,staticGraphWithDragAndDrop:!!e.newCoords,initialZoom:b,node:{labelProperty:"dispLabel",fontSize:14},d3:{alphaTarget:.05,gravity:-100,linkLength:100,linkStrength:1,disableLinkForce:!1},link:{highlightColor:"lightblue",renderLabel:!0,labelProperty:"dispLabel"}},v=Object(r.useRef)();Object(r.useEffect)((function(){C(),e.newLinks&&!v.current.state.d3Links.length&&(v.current.state.d3Links=e.newLinks);var t=v.current.state.d3Links;e.returnLinks(t)}));var C=function(){for(var t=v.current.state.nodes,n={},r=0,a=Object.entries(t);r<a.length;r++){var o=Object(g.a)(a[r],2),i=o[0],s=o[1];n[i]={x:s.x,y:s.y}}e.returnCoords(n)};return a.a.createElement(f.Graph,{ref:v,config:k,id:"d3graph",data:function(e){var t={nodes:Object.values(e.visibleGraph.toJS().nodes),links:Object.values(e.visibleGraph.toJS().edges)},n=e.cardNodeIds.toJS();return t.nodes=t.nodes.map((function(t){return n.includes(t.id)?(t.fontSize=16,t.dispLabel=" ",t.viewGenerator=function(t){return a.a.createElement(te,{node:t,getDimensions:function(e,t){o(e),ne[t]=e},vGraph:e.visibleGraph,iGraph:e.invisibleGraph,onButtonClick:e.onButtonClick,onMinimizeClick:e.onMinimizeClick})}):(t.svg=W[t.labels[0]].svg,t.size=600,t.fontSize=16,t.highlightFontSize=24,t.dispLabel=V(t.properties[W[t.labels[0]].contentTextParam])),t})),t.nodes=t.nodes.map((function(t){return n.includes(t.id)&&(t.size={height:ne[t.id],width:2400}),e.newCoords&&e.newCoords.hasOwnProperty(t.id)&&(t.x=e.newCoords[t.id].x,t.y=e.newCoords[t.id].y),t})),t.links=t.links.map((function(e){var t=Object(m.a)(Object(m.a)({},e),Z[e.type].linkConf);if(0!==Z[t.type].properties.length){Z[t.type].result.forEach((function(e){e.value.toLowerCase().includes(t.properties.result.substring(0,7).toLowerCase())&&e.regex?t.color=e.color:console.log("LINK NOT RED")}));for(var n="",r=0,a=Object.values(Z[t.type].properties);r<a.length;r++){var o=a[r];n=n+t.properties[o]+" "}t.dispLabel=n}else t.dispLabel=_(t.type,"ru");return t})),t}(e),onNodePositionChange:function(e,t,n){C()},onDoubleClickNode:function(t){e.onNodeClick(t)}})}),(function(e,t){return e.visibleGraph===t.visibleGraph&&e.invisibleGraph===t.invisibleGraph&&e.cardNodeIds===t.cardNodeIds}));function ae(e,t){return e.records.forEach((function(e,n){e.keys.forEach((function(n){var r=e.get(n);r.hasOwnProperty("start")?t.edges[r.identity.low]={source:r.start.low,target:r.end.low,type:r.type,properties:r.properties}:t.nodes[r.identity.low]={id:r.identity.low,labels:r.labels,properties:r.properties}}))})),t}function oe(e,t){return Object.keys(t.edges).forEach((function(n){Object.keys(e.nodes).includes(t.edges[n].source.toString())&&Object.keys(e.nodes).includes(t.edges[n].target.toString())&&(e.edges[n]=t.edges[n])})),e}var ie=n(442),se=n(443),le=n(451),ce=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).driver=h.a.driver("bolt://neo4j.kloop.io:7687"),e.state={visibleGraph:p.a.fromJS({nodes:{},edges:{}}),invisibleGraph:p.a.fromJS({nodes:{},edges:{}}),cardNodeIds:p.a.fromJS([9350,18766,371947]),showSpinner:!1,showSmallSpinner:!1},e.clearGraphs=function(){e.setState({visibleGraph:p.a.fromJS({nodes:{},edges:{}}),invisibleGraph:p.a.fromJS({nodes:{},edges:{}})})},e.goClick=function(t){e.props.errorMessage(""),e.executeQuery(t)},e.executeQuery=function(t){e.setState({showSpinner:!0});var n=e.driver.session();n.run(t).then((function(t){var n=ae(t,e.state.visibleGraph.toJS()),r=Object.keys(n.nodes).toString();e.setState({visibleGraph:p.a.fromJS(n)}),e.updateInvisible(r,n,e.state.invisibleGraph.toJS())})).catch((function(t){console.log(t),e.props.errorMessage("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u0432\u043e \u0432\u0440\u0435\u043c\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u043f\u0440\u043e\u0441\u0430")})).then((function(){n.close(),e.setState({showSpinner:!1})}))},e.updateInvisible=function(t,n,r){e.setState({showSmallSpinner:!0});var a=e.driver.session();a.run("MATCH (n)-[r]-(b) WHERE ID(n) in ["+t+"] RETURN n, r, b").then((function(t){var a=ae(t,r);n=oe(n,a),e.setState({visibleGraph:p.a.fromJS(n),invisibleGraph:p.a.fromJS(a)})})).catch((function(t){console.log(t),e.props.errorMessage("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0435 \u0441\u0432\u044f\u0437\u0435\u0439")})).then((function(){a.close(),e.setState({showSmallSpinner:!1})}))},e.mergeGraphs=function(t,n,r){t.forEach((function(e){n.edges[e]=r.edges[e],n.nodes[n.edges[e].source]=r.nodes[r.edges[e].source],n.nodes[n.edges[e].target]=r.nodes[r.edges[e].target]}));var a=oe(n,r);return e.updateInvisible(t,a,e.state.invisibleGraph.toJS()),a=oe(a,e.state.invisibleGraph.toJS())},e.removeElements=function(t,n,r,a){var o=e.findNodes(r.nodes,r.edges,t);return t.forEach((function(e){var t="target",a=r.nodes[r.edges[e][t]];a.id===parseInt(n)&&(t="source",a=r.nodes[r.edges[e][t]]),Object.keys(o).includes(String(a.id))||(delete r.nodes[r.edges[e][t]],delete r.edges[e])})),console.log("remove vGraph result: ",r),[r,a]},e.handleButtonClick=function(t,n){Object.keys(e.state.visibleGraph.toJS().edges);var r,a=e.state.visibleGraph.toJS(),o=e.state.invisibleGraph.toJS();r=e.mergeGraphs(t,a,o);var i=e.findNodes(r.nodes,r.edges,t);e.updateInvisible(Object.keys(i),r,o),console.log("updated visible graph: ",r),e.setState({visibleGraph:p.a.fromJS(r)})},e.removeFromArray=function(t){var n=e.state.cardNodeIds.toJS(),r=n.indexOf(parseInt(t));return r>-1&&n.splice(r,1),n},e.addToArray=function(t){var n=e.state.cardNodeIds.toJS();return-1===n.indexOf(parseInt(t))&&n.push(parseInt(t)),n},e.handleMinimezeClick=function(t){console.log("minimize clicked",t);var n=e.removeFromArray(t);e.setState({cardNodeIds:p.a.fromJS(n)})},e.handleNodeClick=function(t){if(console.log("node clicked",t),!e.state.cardNodeIds.toJS().includes(parseInt(t))){var n=e.addToArray(t);e.setState({cardNodeIds:p.a.fromJS(n)})}},e.returnSpinner=function(){return a.a.createElement("div",{style:{position:"absolute",height:"100px",width:"100px",top:"50%",left:"50%",marginLeft:"-50px",marginTop:"-50px"}},a.a.createElement(ie.a,{size:100,style:{color:"grey"}}))},e.returnSmallSpinner=function(){return a.a.createElement(se.a,{container:!0,alignContent:"flex-end",direction:"column",style:{position:"absolute",right:0,paddingRight:"10px"}},a.a.createElement(le.a,null,a.a.createElement(ie.a,{size:32,style:{color:"grey"}})),a.a.createElement(y.a,{variant:"body2",component:"p",style:{fontSize:"12px"}},"C\u0432\u044f\u0437\u0438 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u044e\u0442\u0441\u044f"))},e}return Object(l.a)(n,[{key:"componentDidUpdate",value:function(e){e.isGoClick!==this.props.isGoClick&&(this.goClick(this.props.cypherQuery),this.props.goClick()),e.isClearGraph!==this.props.isClearGraph&&(this.clearGraphs(),this.props.clearClick())}},{key:"findNodes",value:function(e,t,n,r){var a={};return Object.keys(e).forEach((function(r){n.forEach((function(n){e[r].id!==t[n].source&&e[r].id!==t[n].target||(a[r]=e[r])}))})),a}},{key:"render",value:function(){var e=null;return 0!==Object.keys(this.state.visibleGraph.toJS().nodes).length&&(e=a.a.createElement(re,{onButtonClick:this.handleButtonClick,onMinimizeClick:this.handleMinimezeClick,onNodeClick:this.handleNodeClick,visibleGraph:this.state.visibleGraph,invisibleGraph:this.state.invisibleGraph,cardNodeIds:this.state.cardNodeIds,returnCoords:this.props.returnCoords,newCoords:this.props.newCoords,returnLinks:this.props.returnLinks,newLinks:this.props.newLinks,zoom:this.props.zoom,resetZoom:this.props.resetZoom})),a.a.createElement("div",null,this.state.showSmallSpinner?this.returnSmallSpinner():null,this.state.showSpinner?this.returnSpinner():e)}}]),n}(r.Component),de=n(452),ue=n(259),he=n.n(ue),pe=n(124),me=n(4),ge=n(40),fe=n(454),be=n(444),ke=n(445),ve=n(446),Ce=n(260),Se=n.n(Ce),Ee=n(264),ye=n.n(Ee),we=n(265),Oe=n.n(we),Ne=n(263),Le=n.n(Ne),Te=n(262),Ie=n.n(Te),Ge=n(450),Pe=n(449),xe=n(266),Ae=n.n(xe),je=n(455),_e=Object(b.a)((function(e){return{root:{display:"flex"},appBar:{background:"transparent",boxShadow:"none",transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{width:"calc(100% - ".concat(240,"px)"),marginLeft:240,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},menuButton:{color:"gray",marginRight:e.spacing(2)},hide:{display:"none"},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},drawerHeader:Object(m.a)(Object(m.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),content:{flexGrow:1,padding:e.spacing(3),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-240},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0},searchBar:{width:"600px",paddingLeft:13,paddingRight:13,border:"2px solid gray",borderRadius:25}}}));function Re(e){var t=_e(),n=Object(ge.a)(),r=a.a.useState(!1),o=Object(g.a)(r,2),i=o[0],s=o[1];return a.a.createElement("div",{className:t.root},a.a.createElement(be.a,null),a.a.createElement(ke.a,{position:"fixed",className:Object(me.a)(t.appBar,Object(pe.a)({},t.appBarShift,i))},a.a.createElement(ve.a,null,a.a.createElement(E.a,{color:"inherit","aria-label":"open drawer",onClick:function(){s(!0)},edge:"start",className:Object(me.a)(t.menuButton,i&&t.hide)},a.a.createElement(Se.a,null)),a.a.createElement(Ge.a,{style:{color:"grey"},className:t.searchBar,value:e.searchText,onChange:e.handleSearchTextChange,placeholder:"\u041f\u043e\u0438\u0441\u043a...",onKeyPress:function(t){"Enter"===t.key&&e.handleGoClick()},InputProps:{disableUnderline:!0,inputProps:{"aria-label":"Search"}}}),a.a.createElement(je.a,{title:"\u041f\u043e\u0438\u0441\u043a"},a.a.createElement(E.a,{"aria-label":"search",onClick:e.handleGoClick},a.a.createElement(Ie.a,null))),a.a.createElement(je.a,{title:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"},a.a.createElement(E.a,{"aria-label":"clear",onClick:e.handleClearClick},a.a.createElement(Le.a,null))))),a.a.createElement(fe.a,{className:t.drawer,variant:"persistent",anchor:"left",open:i,classes:{paper:t.drawerPaper}},a.a.createElement("div",{className:t.drawerHeader},a.a.createElement(E.a,{onClick:function(){s(!1)}},"ltr"===n.direction?a.a.createElement(ye.a,null):a.a.createElement(Oe.a,null))),a.a.createElement(L.a,null),a.a.createElement(T.a,null,["\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u0430\u043f\u0440\u043e\u0441:"].map((function(e,t){return a.a.createElement(I.a,{key:e},a.a.createElement(P.a,{primary:e}))}))),a.a.createElement(T.a,null,a.a.createElement(Ge.a,{id:"query",label:"\u0417\u0430\u043f\u0440\u043e\u0441",variant:"outlined",multiline:!0,value:e.cypherQuery,onChange:e.handleCypherQueryTextChange})),a.a.createElement(T.a,null,a.a.createElement(Pe.a,{variant:"contained",className:t.GoButton,onClick:e.handleGoClick,startIcon:a.a.createElement(Ae.a,null)},"\u041f\u043e\u0438\u0441\u043a")),a.a.createElement(T.a,null,a.a.createElement(Pe.a,{variant:"contained",onClick:function(){var t=JSON.stringify(e.nodeCoords);console.log(t),navigator.clipboard.writeText(t)}},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0432 \u0431\u0443\u0444\u0435\u0440")),a.a.createElement(T.a,null,a.a.createElement(Ge.a,{id:"coords",label:"\u041a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u044b",variant:"outlined",multiline:!0,value:JSON.stringify(e.nodeCoords)})),a.a.createElement(T.a,null,a.a.createElement(Ge.a,{id:"links",label:"\u0421\u0432\u044f\u0437\u0438",variant:"outlined",multiline:!0,value:JSON.stringify(e.nodeLinks)}))),a.a.createElement("main",{style:{padding:0,height:"100%",background:"transparent"},className:Object(me.a)(t.content,Object(pe.a)({},t.contentShift,i))},a.a.createElement("div",{className:t.drawerHeader}),e.children))}var ze=n(354).default,Be=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={cypherQuery:"MATCH (n) where id(n) in [2437183, 18766, 2460290, 371947, 9350, 2437735, 1150073] return n",searchText:"",goClick:!1,clearGraph:!1,listOfNodes:null,showPagination:!1,errorMessage:"",newCoords:null,coords:{},allCoords:null,newLinks:null,links:[],allLinks:null,zoom:null,allZoom:null},e.handleCypherQueryTextChange=function(t){e.setState({cypherQuery:t.target.value})},e.handleSearchTextChange=function(t){var n="MATCH (n) where n.text_search =~ '.*"+t.target.value.toLowerCase()+".*' return n";e.setState({searchText:t.target.value,cypherQuery:n})},e.handlePaginationChange=function(t,n){e.handleClearClick();var r=null,a=null,o=null,i=null;e.state.listOfNodes?r=e.state.listOfNodes[n-1]:e.state.allCoords&&(a=e.state.allCoords[n-1],r=Object.keys(a)),e.state.allLinks&&(e.state.listOfNodes||e.state.allCoords)&&(o=e.state.allLinks[n-1]),e.state.allZoom&&(i=e.state.allZoom[n-1]);var s="MATCH (n) where id(n) in ["+r+"] return n";e.setState({cypherQuery:s,newCoords:a,newLinks:o,zoom:i}),e.handleGoClick()},e.fetchData=function(t){ze.get(t.url,{params:{token:t.token}}).then((function(t){var n="ERROR",r=0;if(t.data.nodes){var a=t.data.nodes;n="MATCH (n) where id(n) in ["+a[0]+"] return n",r=a.length,e.setState({listOfNodes:a})}else if(t.data.coords){var o=t.data.coords;n="MATCH (n) where id(n) in ["+Object.keys(o[0])+"] return n",r=o.length,e.setState({newCoords:o[0],allCoords:o})}if(t.data.links&&(t.data.nodes||t.data.coords)){var i=t.data.links;e.setState({newLinks:i[0],allLinks:i})}if(t.data.zoom){var s=t.data.zoom;e.setState({zoom:s[0],allZoom:s})}r>1&&e.setState({showPagination:!0}),e.setState({cypherQuery:n}),e.handleGoClick()})).catch((function(t){e.setState({errorMessage:"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0435 \u0434\u0430\u043d\u043d\u044b\u0445. \u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0435 \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442-\u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435"}),console.log("There has been a problem with your fetch operation: "+t.message)}))},e.handleGoClick=function(){e.setState({goClick:!0}),console.log("go button clicked"),console.log("state goClicked ",e.state.goClick)},e.goClick=function(){e.setState({goClick:!1})},e.handleClearClick=function(){e.setState({clearGraph:!0})},e.clearClick=function(){e.setState({clearGraph:!1})},e.handleResetClick=function(){e.handleClearClick(),e.handleGoClick()},e.handleError=function(t){e.setState({errorMessage:t})},e.returnPagination=function(){var t=0;return e.state.listOfNodes?t=e.state.listOfNodes.length:e.state.allCoords&&(t=e.state.allCoords.length),a.a.createElement(se.a,{container:!0,justify:"center",style:{position:"absolute",left:"50%",bottom:"10px",WebkitTransform:"translateX(-50%)",transform:"translateX(-50%)"}},a.a.createElement(de.a,{count:t,onChange:e.handlePaginationChange,size:"small",showFirstButton:!0,showLastButton:!0}))},e.returnCoords=function(t){e.setState({coords:t})},e.returnLinks=function(t){e.setState({links:t})},e.resetZoom=function(t){e.setState({zoom:t})},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=he.a.parse(window.location.search,{decode:!1}),t="";if(e.nodes)t="MATCH (n) where id(n) in ["+e.nodes+"] return n",this.setState({cypherQuery:t}),this.handleGoClick();else if(e.url)this.fetchData(e);else if(e.coords){var n=decodeURI(e.coords),r=JSON.parse(n);t="MATCH (n) where id(n) in ["+Object.keys(r)+"] return n",this.setState({newCoords:r}),this.setState({cypherQuery:t}),this.handleGoClick()}if(e.links&&(e.nodes||e.coords)){var a=decodeURI(e.links),o=JSON.parse(a);this.setState({newLinks:o})}e.zoom&&this.setState({zoom:e.zoom})}},{key:"render",value:function(){return a.a.createElement("div",{className:"App"},a.a.createElement(Re,{cypherQuery:this.state.cypherQuery,handleCypherQueryTextChange:this.handleCypherQueryTextChange,searchText:this.state.searchText,handleSearchTextChange:this.handleSearchTextChange,handleGoClick:this.handleGoClick,handleClearClick:this.handleClearClick,nodeCoords:this.state.coords,nodeLinks:this.state.links},this.state.errorMessage&&a.a.createElement("h3",{className:"error"}," ",this.state.errorMessage," "),a.a.createElement(ce,{cypherQuery:this.state.cypherQuery,isGoClick:this.state.goClick,goClick:this.goClick,isClearGraph:this.state.clearGraph,clearClick:this.clearClick,errorMessage:this.handleError,returnCoords:this.returnCoords,newCoords:this.state.newCoords,returnLinks:this.returnLinks,newLinks:this.state.newLinks,zoom:this.state.zoom,resetZoom:this.resetZoom}),this.state.showPagination?this.returnPagination():null))}}]),n}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(Be,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[284,1,2]]]);
//# sourceMappingURL=main.38e4c71b.chunk.js.map